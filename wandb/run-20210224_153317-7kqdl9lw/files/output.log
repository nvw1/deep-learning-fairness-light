/opt/conda/lib/python3.7/site-packages/torch/cuda/__init__.py:52: UserWarning: CUDA initialization: Found no NVIDIA driver on your system. Please check that you have an NVIDIA GPU and installed a driver from http://www.nvidia.com/Download/index.aspx (Triggered internally at  /opt/conda/conda-bld/pytorch_1607370156314/work/c10/cuda/CUDAFunctions.cpp:100.)
  return torch._C._cuda_getDeviceCount() > 0
playing.py:435: YAMLLoadWarning: calling yaml.load() without Loader=... is deprecated, as the default Loader is unsafe. Please read https://msg.pyyaml.org/load for full details.
  params = yaml.load(f)
current path: saved_models/model_test_Feb.24_15.33.18
DP: True
128
5e-05
0.9
Finished preprocessing the CelebA dataset...
Finished preprocessing the CelebA dataset...
Length of CelebA dataset: 24000
Dataset size: 24000. Computing RDP guarantees.
DP-SGD with sampling rate = 0.533% and noise_multiplier = 0.5 iterated over 1875 steps satisfies differential privacy with eps = 15.2 and delta = 1e-06.
The optimal RDP order is 2.25.
Model size: 2
Total number of params for model resnet: 11177538
| name | test_batch_s | batch_size | num_microbat | lr | momentum | decay | S | z | mu | dp | epochs | save_on_epoc | optimizer | scheduler | save_model | dataset | model | image_dir | attr_path | selected_att | protected_at | labels | multi_gpu | environment_ | current_time |
|---|:---|:---|:---|:---|:---|:---|:---|:---|:---|:---|:---|:---|:---|:---|:---|:---|:---|:---|:---|:---|:---|:---|:---|:---|:---|
| smiling_celeba_non_dp_27k_female | 128 | 128 | 128 | 5e-05 | 0.9 | 5e-4 | 5 | 0.5 | 0.9 | True | 10 | [10, 20, 40, 60] | Adam | False | True | celeba | resnet | /Users/nvw3/Downloads/celeba/img_align_celeba/img_align_celeba/ | /Users/nvw3/Downloads/celeba/imbalanced_attr/27k_female.csv | Smiling | Male | [0, 1] | False | test | Feb.24_15.33.18 |
[0, 1]
  0%|          | 0/187 [00:00<?, ?it/s]  0%|          | 0/187 [01:32<?, ?it/s]
Traceback (most recent call last):
  File "playing.py", line 618, in <module>
    train_dp(helper.train_loader, net, optimizer, epoch)
  File "playing.py", line 318, in train_dp
    j.backward(retain_graph=True)
  File "/opt/conda/lib/python3.7/site-packages/torch/tensor.py", line 221, in backward
    torch.autograd.backward(self, gradient, retain_graph, create_graph)
  File "/opt/conda/lib/python3.7/site-packages/torch/autograd/__init__.py", line 132, in backward
    allow_unreachable=True)  # allow_unreachable flag
KeyboardInterrupt
